## References {.page_break_before}

<!-- Explicitly insert bibliography here -->
<div id="refs"></div>

## Figure legends

![**Structural variation in vg.** 
a) vg uses the read coverage over possible paths to genotype variants in a snarl. The cartoon depicts the case of an heterozygous insertion and an homozygous deletion. The algorithm is described in detail in [Methods](#sv-genotyping-algorithm).
b) Simulation experiment. Each subplot shows a comparison of genotyping accuracy for five methods. Results are separated between types of variation (insertions, deletions, and inversions). The experiments were also repeated with small random errors introduced to the VCF to simulate breakpoint uncertainty. For each experiment, the x-axis is the simulated read depth and the y-axis shows the maximum F1 across different minimum quality thresholds.
SVTyper cannot genotype insertions, hence the missing line in the top panels.
](images/panel1.png){#fig:1}

![**Structural variants from the HGSVC and Genome in a Bottle datasets**. 
HGSVC: Simulated and real reads were used to genotype SVs and compared with the high-quality calls from Chaisson et al.[@tag:hgsvc].
Reads were simulated from the HG00514 individual.
Using real reads, the three HG00514, HG00733, and NA19240 individuals were tested.
GIAB: Real reads from the HG002 individual were used to genotype SVs and compared with the high-quality calls from the Genome in a Bottle consortium[@doi:10.1038/sdata.2016.25;@doi:10.1038/s41587-019-0074-6;@doi:10.1101/664623].
a) Maximum F1 score for each method (color), across the whole genome or focusing on non-repeat regions (x-axis). 
We evaluated the ability to predict the presence of an SV (transparent bars) and the exact genotype (solid bars).
Results are separated across panels by variant type: insertions and deletions.
SVTyper cannot genotype insertions, hence the missing bars in the top panels.
b) Maximum F1 score for different size classes when evaluating on the presence of SVs across the whole genome.
c) Size distribution of SVs in the HGSVC and GIAB catalogs.
](images/panel2.png){#fig:2 width="90%"}

![**Exonic deletion in the HGSVC dataset correctly genotyped by vg**. 
a) Visualization of the HGSVC graph as augmented by reads aligned by vg at a locus harboring a 51 bp homozygous deletion in the UTR region of the LONRF2 gene.
At the bottom, a horizontal black line represents the topologically sorted nodes of the graph.
Black rectangles represent edges found in the graph.
Above this rendering of the topology, the reference path from GRCh38 is shown (in green).
Red and blue bars represent reads mapped to the graph.
Thin lines in the reference path and read mappings highlight relative gaps (either insertions or deletions) against the full graph.
The vg read mappings show consistent coverage even over the deletion.
b) Reads mapped to the linear genome reference GRCh38 using bwa mem[@arxiv:1303.3997] in the same region.
Reads contain soft-clipped sequences and short insertions near the deletion breakpoints.
Part of the deleted region is also covered by several reads, potentially confusing traditional SV genotypers.
](images/hgsvc-ex-del.png){#fig:hgsvc-ex  width="80%"}

![**Structural variants from SMRT-SV v2 [@tag:audano2019]**.
The pseudo-diploid genome built from two CHM cell lines and one negative control sample was originally used to train SMRT-SV v2 Genotyper in Audano et al.[@tag:audano2019].
It contains 16,180 SVs.
The SVPOP panel shows the combined results for the HG00514, HG00733, and NA19240 individuals, three of the 15 individuals used to generate the high-quality SV catalog in Audano et al. [@tag:audano2019].
Here, we report the maximum F1 score (y-axis) for each method (color), across the whole genome or focusing on non-repeat regions (x-axis). 
We evaluated the ability to predict the presence of an SV (transparent bars) and the exact genotype (solid bars).
Genotype information is not available in the SVPOP catalog hence genotyping performance could not be evaluated.
](images/chmpd-svpop-best-f1.png){#fig:chmpd-svpop}

![**SV genotyping comparison.**
Short reads from all 11 non-reference yeast strains were used to genotype SVs contained in the *cactus graph* and the *VCF graph*. 
Subsequently, sample graphs were generated from the resulting SV genotype sets. 
The short reads were aligned to the sample graphs and reads with identical mapping identity and quality across both sample graphs and an additional empty sample graph were removed from the analysis.
The quality of the remaining divergent alignments was used to ascertain SV genotyping performance.
The bars show the average delta in mapping identity (a) and in mapping quality (b) of divergent short reads aligned to the sample graphs derived from the *cactus graph* and the *VCF graph*.
Positive values denote an improvement of the *cactus graph* over the *VCF graph*.
Colors represent the two strain sets and transparency indicates whether the respective strain was part of the *five strains set*.
](images/panel4.png){#fig:4}
